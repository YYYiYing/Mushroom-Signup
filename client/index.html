import React, { useState, useEffect } from 'react';
import { 
  Container, 
  Form, 
  Button, 
  Card, 
  Dropdown, 
  Modal 
} from 'react-bootstrap';

// 蘑菇類型常數
const MUSHROOM_TYPES = [
  '巨菇', '活動菇', '大晶', '大火', '大水', 
  '大電', '大毒', '大紅', '大黃', '大藍', 
  '大紫', '大粉', '大灰', '大白', '晶', 
  '水', '火', '電', '毒'
];

// 使用者介面
interface User {
  id: string;
  username: string;
  remainingChallenges: number;
}

// 報名活動介面
interface MushroomEvent {
  id: string;
  publisherName: string;
  mushroomType: string;
  openTime: Date;
  maxParticipants: number;
  participants: Array<{
    username: string;
    registrationTime: Date;
  }>;
}

const MushroomSignupSystem: React.FC = () => {
  // 狀態管理
  const [currentUser, setCurrentUser] = useState<User | null>(null);
  const [users, setUsers] = useState<User[]>([]);
  const [events, setEvents] = useState<MushroomEvent[]>([]);
  const [showLoginModal, setShowLoginModal] = useState(true);
  const [showCreateEventModal, setShowCreateEventModal] = useState(false);

  // 登入邏輯
  const handleLogin = (username: string) => {
    const existingUser = users.find(u => u.username === username);
    if (existingUser) {
      setCurrentUser(existingUser);
    } else {
      const newUser: User = {
        id: `user_${Date.now()}`,
        username,
        remainingChallenges: 3
      };
      setUsers([...users, newUser]);
      setCurrentUser(newUser);
    }
    setShowLoginModal(false);
  };

  // 建立報名活動
  const createEvent = (event: Omit<MushroomEvent, 'id' | 'participants'>) => {
    const newEvent: MushroomEvent = {
      id: `event_${Date.now()}`,
      ...event,
      participants: []
    };
    setEvents([...events, newEvent]);
    setShowCreateEventModal(false);
  };

  // 報名活動
  const registerForEvent = (eventId: string) => {
    // 實作報名邏輯
    // 檢查時間、人數等限制
  };

  return (
    <Container>
      {/* 登入彈窗 */}
      <Modal show={showLoginModal} onHide={() => {}}>
        {/* 登入表單 */}
      </Modal>

      {/* 建立報名活動彈窗 */}
      <Modal show={showCreateEventModal} onHide={() => setShowCreateEventModal(false)}>
        {/* 建立報名表單 */}
      </Modal>

      {/* 報名清單 */}
      <Card>
        <Card.Header>蘑菇報名清單</Card.Header>
        <Card.Body>
          {/* 顯示報名活動 */}
        </Card.Body>
      </Card>
    </Container>
  );
};

export default MushroomSignupSystem;
